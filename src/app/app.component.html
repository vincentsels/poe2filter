<div class="container-fluid full" id="app">
  <div class="content">

    <div class="wrapper">
      <div id="statusBar">
        <div class="statusBarCenter"></div>
        <div class="statusBarRight"></div>
      </div>
      <div class="logo">
        <a href="https://poe2filter.com">
          <img src="/logo-filter.png">
        </a>
      </div>

      <div id="trade" class="block">
        <div class="navigation">
          <ul role="tablist" class="nav nav-tabs main">
            <li role="presentation" class="menu-tab menu-quick-filter" [class.active]="tab === 'quickFilters'">
              <a (click)="tab = 'quickFilters'">
                <span>Quick Filters</span>
              </a>
            </li>
            <li role="presentation" class="menu-tab menu-cosmetic" [class.active]="tab === 'cosmetic'">
              <a (click)="tab = 'cosmetic'">
                <span>Cosmetic</span>
              </a>
            </li>
            <li role="presentation" class="menu-tab menu-custom-rules" [class.active]="tab === 'customRules'">
              <a (click)="tab = 'customRules'">
                <span>Custom Rules</span>
              </a>
            </li>
            <li role="presentation" class="menu-tab menu-advanced-rules" [class.active]="tab === 'freeRules'">
              <a (click)="tab = 'freeRules'">
                <span>Free Rules</span>
              </a>
            </li>
          </ul>
          <ul role="tablist" class="nav nav-tabs account">
            <li role="presentation" class="menu-about">
            </li>
            <li role="presentation" class="menu-settings">
            </li>
          </ul>
        </div>
        <div class="top">
          <div class="search-panel">
            <div class="search-bar search-advanced">
              @if(tab === 'quickFilters') {
              <div class="search-advanced-items">

                @if (filterResetWarning) {
                <div class="row row-total row-justify-content-left">
                  <div class="info" style="position: relative;">
                    <h2 class="info-title">Heads up! <strong>Your previously stored filter was reset!</strong></h2>
                    Due to a breaking change in the structure of the filter, your previously stored filter could not be reloaded.
                    Please revise all settings. You can copy any 'Free Rules' from your current filter file. We apologize for this inconvenience.
                    <div class="close-info-btn" (click)="filterResetWarning = false">✕</div>
                  </div>
                </div>
                }

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Flask and Charm Filters
                            <div class="filter-tip"><p>Uniques will not be hidden.</p></div>
                        </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideLifeFlasks">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideLifeFlasks" (click)="toggleHideLifeFlasks()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Life Flasks
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="lifeFlaskBaseTypes"
                            [disabled]="!filter.hideLifeFlasks"
                            [showOptions]="true"
                            [selectedValues]="filter.hideLifeFlasksBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideLifeFlasksBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                          <span class="sep"></span>
                          <div class="filter-title filter-label" [class.disabled]="filter.hideLifeFlasks && filter.hideLifeFlasksBaseTypeExceptions.includes('None')">
                            Of Quality
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.hideLifeFlasks || filter.hideLifeFlasksBaseTypeExceptions.includes('None')"
                            [(ngModel)]="filter.hideLifeFlasksQuality" (change)="updateFilter()">
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideManaFlasks">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideManaFlasks" (click)="toggleHideManaFlasks()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Mana Flasks
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="manaFlaskBaseTypes"
                            [disabled]="!filter.hideManaFlasks"
                            [showOptions]="true"
                            [selectedValues]="filter.hideManaFlasksBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideManaFlasksBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                          <span class="sep"></span>
                          <div class="filter-title filter-label" [class.disabled]="filter.hideLifeFlasks && filter.hideManaFlasksBaseTypeExceptions.includes('None')">
                            Of Quality
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.hideManaFlasks || filter.hideManaFlasksBaseTypeExceptions.includes('None')"
                            [(ngModel)]="filter.hideManaFlasksQuality" (change)="updateFilter()">
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideCharms">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideCharms" (click)="toggleHideCommonCharms()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Charms
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="charmBaseTypes"
                            [disabled]="!filter.hideCharms"
                            [showOptions]="true"
                            [selectedValues]="filter.hideCharmsBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideCharmsBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                          <span class="sep"></span>
                          <div class="filter-title filter-label" [class.disabled]="filter.hideCharms && filter.hideCharmsBaseTypeExceptions.includes('None')">
                            Of Quality
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.hideCharms || filter.hideCharmsBaseTypeExceptions.includes('None')"
                            [(ngModel)]="filter.hideCharmsQuality" (change)="updateFilter()">
                        </span>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Currency Filters
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideScrolls">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideScrolls" (click)="toggleHideScrolls()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Scrolls of Wisdom
                          </div>
                        </span>
                      </div>

                      <div class="filter full-span" [class.disabled]="!filter.hideGold">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideGold" (click)="toggleHideGold()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Gold Stacks Lower Than
                            <div class="filter-tip"><p>You will still pick up smaller stacks too. Stacks 20 times higher will be highlighted in white, 100 times higher in yellow.</p></div>
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="4" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.hideGold" [(ngModel)]="filter.hideGoldLowerThan" (change)="updateFilter()">
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideCurrency">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideCurrency" (click)="toggleHideCurrency()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Currency
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="baseCurrencyTypes"
                            [disabled]="!filter.hideCurrency"
                            [showOptions]="true"
                            [selectedValues]="filter.hideCurrencyTypes"
                            (selectedValuesChange)="filter.hideCurrencyTypes = $event; updateFilter();"></pf-autocomplete>
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideRunes">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideRunes" (click)="toggleHideRunes()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Runes
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="runeBaseTypes"
                            [disabled]="!filter.hideRunes"
                            [showOptions]="true"
                            [selectedValues]="filter.hideRunesExceptions"
                            (selectedValuesChange)="filter.hideRunesExceptions = $event; updateFilter();"></pf-autocomplete>
                        </span>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Jewellery Filters
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter full-span" [class.disabled]="!filter.hideAmulets">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideAmulets" (click)="toggleHideAmulets()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Amulets
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 180px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.hideAmulets" [(ngModel)]="filter.hideAmuletsOfRarity" (change)="updateFilter()">
                                <option [value]="RarityToHide.Normal">Normal</option>
                                <option [value]="RarityToHide.NormalAndMagic">Normal and Magic</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="amuletBaseTypes"
                            [disabled]="!filter.hideAmulets"
                            [showOptions]="true"
                            [selectedValues]="filter.hideAmuletsBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideAmuletsBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                        </span>
                      </div>

                      <div class="filter full-span" [class.disabled]="!filter.hideRings">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideRings" (click)="toggleHideRings()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Rings
                            <div class="filter-tip"><p>Breach Rings will always be highlighted in Brown.</p></div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 180px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.hideRings" [(ngModel)]="filter.hideRingsOfRarity" (change)="updateFilter()">
                                <option [value]="RarityToHide.Normal">Normal</option>
                                <option [value]="RarityToHide.NormalAndMagic">Normal and Magic</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="ringBaseTypes"
                            [disabled]="!filter.hideRings"
                            [showOptions]="true"
                            [selectedValues]="filter.hideRingsBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideRingsBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                        </span>
                      </div>

                      <div class="filter full-span" [class.disabled]="!filter.hideBelts">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideBelts" (click)="toggleHideBelts()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Belts
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 180px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.hideBelts" [(ngModel)]="filter.hideBeltsOfRarity" (change)="updateFilter()">
                                <option [value]="RarityToHide.Normal">Normal</option>
                                <option [value]="RarityToHide.NormalAndMagic">Normal and Magic</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div class="filter-title filter-label">
                            Except
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [allLabel]="'None'"
                            [options]="beltBaseTypes"
                            [disabled]="!filter.hideBelts"
                            [showOptions]="true"
                            [selectedValues]="filter.hideBeltsBaseTypeExceptions"
                            (selectedValuesChange)="filter.hideBeltsBaseTypeExceptions = $event; updateFilter();"></pf-autocomplete>
                        </span>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Additional Highlights
                            <div class="filter-tip"><p>All currency is highlighted and shown on the minimap. This allows you to highlight additional items and show them on the minimap, to make them stand out.</p></div>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span" [class.disabled]="!filter.highlightUniques">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.highlightUniques" (click)="toggleHighlightUniques()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Highlight Uniques
                          </div>
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.highlightChanceBases">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.highlightChanceBases" (click)="toggleHighlightChanceBases()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Highlight Chance Bases
                            <div class="filter-tip"><p>This always shows or highlights (in brown) Normal items which are good or excellent candidates to use a Chance Orb on, respectively.</p></div>
                          </div>
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.highlightRareJewellery">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.highlightRareJewellery" (click)="toggleHighlightRareJewellery()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Highlight Rare Jewellery
                            <div class="filter-tip"><p>Rare jewellery (Amulets, Rings, Belts) is always shown, but this will additionally highlight it to make it stand out.</p></div>
                          </div>
                        </span>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                </div>

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Gear Filters
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span" [class.disabled]="!filter.hideNormalAndMagicItems">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.hideNormalAndMagicItems" (click)="toggleHideNormalAndMagicItems()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Hide Weapons And Armour
                            <div class="filter-tip"><p>Hides all Normal and/or Magic and/or Rare Weapons and Armour; except for the ones specified in the Weapon and Armour filter below.
                            <br /><br /><strong>Warning!</strong> If you are hiding All Rares, be sure to add custom rules for the Weapon and Armour types you use, below.</p></div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 271px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.hideNormalAndMagicItems" [(ngModel)]="filter.hideNormalAndMagicItemsOfRarity" (change)="updateFilter()">
                                <option [value]="WeaponsAndArmourRarityToHide.Normal">Normal</option>
                                <option [value]="WeaponsAndArmourRarityToHide.NormalAndMagic">Normal and Magic</option>
                                <option [value]="WeaponsAndArmourRarityToHide.NormalMagicRareBelowAdvanced">Normal, Magic, Rare &lt; Advanced</option>
                                <option [value]="WeaponsAndArmourRarityToHide.NormalMagicRareBelowExpert">Normal, Magic, Rare &lt; Expert</option>
                                <option [value]="WeaponsAndArmourRarityToHide.NormalMagicRare">Normal, Magic, All Rare</option>
                              </select>
                            </div>
                          </div>
                        </span>
                      </div>

                      @if(filter.hideNormalAndMagicItems) {
                      <div class="filter filter-property full-span" [class.disabled]="!filter.showSocketedItems">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.showSocketedItems" (click)="toggleShowSocketedItems()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Except Socketed Gear
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 271px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.showSocketedItems" [(ngModel)]="filter.showSocketedItemsType" (change)="updateFilter()">
                                <option [value]="SocketedItemType.All">All</option>
                                <option [value]="SocketedItemType.TwoOrMoreSockets">2 Sockets</option>
                              </select>
                            </div>
                          </div>
                        </span>
                      </div>

                      <div class="filter filter-property full-span" [class.disabled]="!filter.showQualityItems">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.showQualityItems" (click)="toggleShowQualityItems()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Except Quality Gear
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 271px;">
                            <div class="multiselect__tags">
                              <select [disabled]="!filter.showQualityItems" [(ngModel)]="filter.showQualityItemsType" (change)="updateFilter()">
                                <option value="All">All</option>
                                <option value="MinimumTenQuality">> 10 Quality</option>
                              </select>
                            </div>
                          </div>
                        </span>
                      </div>
                      }

                    </div>

                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <div class="filter-title">
                            Show Weapon Types
                            <div class="filter-tip"><p>If you checked the 'Hide Weapons And Armour' box before,
                              here you can specify which Weapon Base Types you still want to show Normal and/or Magic items of.
                              Specify whether you only want to show the Advanced and/or Expert versions.
                              Note that Rare and Unique Weapons are always shown.<br/><br/>
                              Note that Sceptres, Staves, Wands and Quivers don't have Advanced or Expert base types. These will be hidden
                              if you only show Advanced or Expert weapons.<br/><br/>
                              You will find Shields in the Armour section below, so you can specify the desired defence type.
                              </p></div>
                          </div>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      @for (weapon of filter.weaponFilters; track $index) {
                      <div class="filter full-span">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!weapon.show" (click)="toggleShowWeapon($index)"></button>
                        </span>
                        <span class="filter-body">
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="weapon.weaponType" (change)="updateWeaponType(weapon); updateFilter();" [disabled]="!weapon.show">
                                <option [value]="WeaponType.All">All</option>
                                <option [value]="WeaponType.Bows">Bows</option>
                                <option [value]="WeaponType.Crossbows">Crossbows</option>
                                <option [value]="WeaponType.Foci">Focus</option>
                                <option [value]="WeaponType.OneHandMaces">One Hand Maces</option>
                                <option [value]="WeaponType.QuarterStaves">QuarterStaves</option>
                                <option [value]="WeaponType.Quivers">Quivers</option>
                                <option [value]="WeaponType.Sceptres">Sceptres</option>
                                <option [value]="WeaponType.Staves">Staves</option>
                                <option [value]="WeaponType.TwoHandMaces">Two Hand Maces</option>
                                <option [value]="WeaponType.Wands">Wands</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 120px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="weapon.rarity" (change)="updateFilter()" [disabled]="!weapon.show">
                                <option [value]="MinimumRarity.Normal">≥ Normal</option>
                                <option [value]="MinimumRarity.Magic">≥ Magic</option>
                                <option [value]="MinimumRarity.Rare">≥ Rare</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 140px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="weapon.baseTypeTier" (change)="updateFilter()" [disabled]="!weapon.show">
                                @if (!weaponTypesWithoutAdvancedAndExpert.includes(weapon.weaponType)) {
                                <option [value]="BaseTypeTier.ExpertOnly">Expert only</option>
                                <option [value]="BaseTypeTier.AdvancedAndExpert">≥ Advanced</option>
                                }
                                <option [value]="BaseTypeTier.All">All</option>
                              </select>
                            </div>
                          </div>
                        </span>
                        <span class="input-group-btn">
                          <button class="btn remove-btn" (click)="removeWeaponType($index)"></button>
                        </span>
                      </div>
                      }

                      <div class="filter filter-padded">
                        <button type="button" class="btn clear-btn" style="width: 100%;" (click)="addWeaponType()">
                          Add Weapon Type
                        </button>
                      </div>
                    </div>
                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <div class="filter-title">
                            Show Armour Types
                            <div class="filter-tip"><p>If you checked the 'Hide Weapons And Armour' box before,
                              here you can specify which Armour Base Types you still want to show Normal and/or Magic items of.
                              Specify whether you only want to show the Advanced and/or Expert versions.
                              Note that Rare and Unique Weapons are always shown.</p></div>
                          </div>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      @for (armour of filter.armourFilters; track $index) {
                      <div class="filter full-span">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!armour.show" (click)="toggleShowArmour($index)"></button>
                        </span>
                        <span class="filter-body">
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="armour.armourType" (change)="updateFilter()" [disabled]="!armour.show">
                                <option [value]="ArmourType.All">All</option>
                                <option [value]="ArmourType.AllButShields">All But Shields</option>
                                <option [value]="ArmourType.BodyArmours">Body Armours</option>
                                <option [value]="ArmourType.Helmet">Helmets</option>
                                <option [value]="ArmourType.Gloves">Gloves</option>
                                <option [value]="ArmourType.Boots">Boots</option>
                                <option [value]="ArmourType.Shields">Shields</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 100px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="armour.defenceType" (change)="updateFilter()" [disabled]="!armour.show">
                                <option [value]="DefenceType.All">All</option>
                                <option [value]="DefenceType.Armour">Arm</option>
                                <option [value]="DefenceType.Evasion">Eva</option>
                                <option [value]="DefenceType.EnergyShield">ES</option>
                                <option [value]="DefenceType.ArmourEvasion">Arm/Eva</option>
                                <option [value]="DefenceType.ArmourEnergyShield">Arm/ES</option>
                                <option [value]="DefenceType.EvasionEnergyShield">Eva/ES</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 120px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="armour.rarity" (change)="updateFilter()" [disabled]="!armour.show">
                                <option [value]="MinimumRarity.Normal">≥ Normal</option>
                                <option [value]="MinimumRarity.Magic">≥ Magic</option>
                                <option [value]="MinimumRarity.Rare">≥ Rare</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 140px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="armour.baseTypeTier" (change)="updateFilter()" [disabled]="!armour.show">
                                <option [value]="BaseTypeTier.ExpertOnly">Expert only</option>
                                <option [value]="BaseTypeTier.AdvancedAndExpert">≥ Advanced</option>
                                <option [value]="BaseTypeTier.All">All</option>
                              </select>
                            </div>
                          </div>
                        </span>
                        <span class="input-group-btn">
                          <button class="btn remove-btn" (click)="removeArmourType($index)"></button>
                        </span>
                      </div>
                      }

                      <div class="filter filter-padded">
                        <button type="button" class="btn clear-btn" style="width: 100%;" (click)="addArmourType()">
                          Add Armour Type
                        </button>
                      </div>
                    </div>
                    <div class="clear"></div>
                  </div>

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Dynamic Filters
                            <div class="filter-tip"><p>Items will be hidden, shown and/or highlighted in a different color based on where you are currently at. This will require you to update the filter regularly.</p></div>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter full-span" [class.disabled]="!filter.dynamicWaystones">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.dynamicWaystones" (click)="toggleDynamicWaystones()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Current Waystone Level
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.dynamicWaystones" [(ngModel)]="filter.dynamicWaystonesLevel" (keyup)="updateFilter()">
                        </span>
                      </div>

                      @if (filter.dynamicWaystones) {
                      <div class="filter full-span" [class.disabled]="!filter.dynamicWaystones">
                        <span class="filter-body filter-body-no-checkbox">
                          <div class="threshold-set">
                            <div class="threshold tier-hidden" title="Waystones tier {{ dynamicWaystoneThresholds[0].level }} are hidden">
                              {{ dynamicWaystoneThresholds[0].level }}
                            </div>
                            <div class="threshold tier-shown" title="Waystones tier {{ dynamicWaystoneThresholds[1].level }} are shown without highlight">
                              {{ dynamicWaystoneThresholds[1].level }}
                            </div>
                            <div class="threshold tier-white" title="Waystones tier {{ dynamicWaystoneThresholds[2].level }} receive a white highlight">
                              {{ dynamicWaystoneThresholds[2].level }}<span class="dot"></span>
                            </div>
                            <div class="threshold tier-yellow" title="Waystones tier {{ dynamicWaystoneThresholds[3].level }} receive a yellow highlight">
                              {{ dynamicWaystoneThresholds[3].level }}<span class="dot"></span>
                            </div>
                            <div class="threshold tier-orange" title="Waystones tier {{ dynamicWaystoneThresholds[4].level }} receive an orange highlight">
                              {{ dynamicWaystoneThresholds[4].level }}<span class="dot"></span>
                            </div>
                            <div class="threshold tier-brown" title="Waystones tier {{ dynamicWaystoneThresholds[5].level }} receive a brown highlight">
                              {{ dynamicWaystoneThresholds[5].level }}<span class="dot"></span>
                            </div>
                          </div>
                        </span>
                      </div>
                      }

                      <div class="filter full-span" [class.disabled]="!filter.dynamicSkillGems">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.dynamicSkillGems" (click)="toggleDynamicSkillGems()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Minimum Skill Gem Level
                          </div>
                          <span class="sep"></span>
                          <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [disabled]="!filter.dynamicSkillGems" [(ngModel)]="filter.dynamicSkillGemsLevel" (keyup)="updateFilter()">
                        </span>
                      </div>

                      @if (filter.dynamicSkillGems) {
                      <div class="filter full-span" [class.disabled]="!filter.dynamicSkillGems">
                        <span class="filter-body filter-body-no-checkbox">
                          <div class="threshold-set">
                            <div class="threshold-label">Skill & Spirit Gems</div>
                            <div class="threshold-values">
                              <div class="threshold tier-hidden" title="Skill gems level {{ dynamicSkillGemThresholds[0].level }} are hidden">
                                {{ dynamicSkillGemThresholds[0].level }}
                              </div>
                              <div class="threshold tier-white" title="Skill gems level {{ dynamicSkillGemThresholds[1].level }} receive a white highlight">
                                {{ dynamicSkillGemThresholds[1].level }}<span class="dot"></span>
                              </div>
                              <div class="threshold tier-yellow" title="Skill gems level {{ dynamicSkillGemThresholds[2].level }} receive a yellow highlight">
                                {{ dynamicSkillGemThresholds[2].level }}<span class="dot"></span>
                              </div>
                            </div>
                          </div>
                        </span>
                      </div>

                      @if ((filter.dynamicSkillGemsLevel || 1) < 17) {
                      <div class="filter full-span" [class.disabled]="!filter.dynamicSkillGems">
                        <span class="filter-body filter-body-no-checkbox">
                          <div class="threshold-set">
                            <div class="threshold-label">Support Gems</div>
                            <div class="threshold-values">
                              <div class="threshold tier-hidden" title="Support gems level {{ dynamicSupportGemThresholds[0].level }} are hidden">
                                {{ dynamicSupportGemThresholds[0].level }}
                              </div>
                              <div class="threshold tier-white" title="Support gems level {{ dynamicSupportGemThresholds[1].level }} receive a white highlight">
                                {{ dynamicSupportGemThresholds[1].level }}<span class="dot"></span>
                              </div>
                              <div class="threshold tier-yellow" title="Support gems level {{ dynamicSupportGemThresholds[2].level }} receive a yellow highlight">
                                {{ dynamicSupportGemThresholds[2].level }}<span class="dot"></span>
                              </div>
                            </div>
                          </div>
                        </span>
                      </div>
                      }
                      }

                    </div>

                    <div class="clear"></div>
                  </div>

                </div>
              </div>
              } @else if (tab === 'cosmetic') {
              <div class="search-advanced-items">

                <div class="row row-total row-justify-content-left">
                  <div class="info reset-font">
                    These settings have no impact on which items are shown or hidden, but change how items are displayed.
                  </div>
                </div>

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded" style="z-index: 100;">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Top-Tier Currency
                            <div class="filter-tip"><p>Plays an alert sound or increases the size of top tier currency (purple and brown) of all types.</p></div>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter full-span" [class.disabled]="!filter.cosmeticTopCurrencyAlertSounds">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.cosmeticTopCurrencyAlertSounds" (click)="toggleCosmeticTopCurrencyAlertSounds()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Play Top-Tier Currency Alert Sounds
                          </div>
                        </span>
                      </div>

                      <div class="filter full-span" [class.disabled]="!filter.cosmeticTopCurrencyLabels">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.cosmeticTopCurrencyLabels" (click)="toggleCosmeticTopCurrencyLabel()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Increased Top-Tier Currency Label Size
                          </div>
                        </span>
                      </div>

                    </div>
                    <div class="clear"></div>
                  </div>

                </div>

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Bare Bone Mode
                            <div class="filter-tip"><p>These settings allow you to remove all styles completely. You can also use them if you want to style everything from scratch.</p></div>
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter full-span" [class.disabled]="!filter.cosmeticRemoveAllHighlights">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.cosmeticRemoveAllHighlights" (click)="toggleCosmeticRemoveAllHighlights()"></button>
                        </span>
                        <span class="filter-body">
                          <div class="filter-title">
                            Disable all Highlights
                          </div>
                        </span>
                      </div>

                      <div class="filter full-span" [class.disabled]="!filter.cosmeticRemoveAllMinimapIcons">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!filter.cosmeticRemoveAllMinimapIcons" (click)="toggleCosmeticRemoveAllMinimapIcons()"></button>
                        </span>
                        <div class="filter-title">
                          Disable all Minimap Icons
                          </div>
                      </div>

                    </div>
                    <div class="clear"></div>
                  </div>
                </div>

                <div class="search-advanced-pane full-width">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Custom Cosmetic Rules
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      @for (rule of filter.customCosmeticRules; track $index) {
                      <div class="filter full-span">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!rule.active" (click)="toggleCustomCosmeticRuleActive($index)"></button>
                        </span>
                        <span class="filter-body">
                          <div tabindex="-1" class="multiselect filter-select" style="width: 180px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.itemType" (change)="itemTypeChanged(rule)" [disabled]="!rule.active">
                                <option [value]="'All'">All</option>
                                @for (itemType of itemData; track itemType.itemType) {
                                <option [value]="itemType.itemType">{{ itemType.itemType }}</option>
                                }
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [options]="getBaseTypesForItemType(rule.itemType)"
                            [disabled]="!rule.active"
                            [showOptions]="rule.itemClass !== 'All'"
                            [selectedValues]="rule.baseTypes"
                            (selectedValuesChange)="selectedValuesChanged(rule, $event)"></pf-autocomplete>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 50px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.rarityComparator" (change)="updateFilter()" [disabled]="!rule.active || currencyItemTypes.includes(rule.itemType)">
                                <option [value]="Comparator.GreaterThanOrEqual">≥</option>
                                <option [value]="Comparator.Equal">=</option>
                                <option [value]="Comparator.LessThanOrEqual">≤</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 120px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.rarity" (change)="updateFilter()" [disabled]="!rule.active || currencyItemTypes.includes(rule.itemType)">
                                <option [value]="Rarity.Normal">Normal</option>
                                <option [value]="Rarity.Magic">Magic</option>
                                <option [value]="Rarity.Rare">Rare</option>
                                <option [value]="Rarity.Unique">Unique</option>
                              </select>
                            </div>
                          </div>
                        </span>
                        <span class="input-group-btn">
                          <button class="btn toggle-button" [class.active]="rule.cosmeticOptions!.labelStyle"
                            (click)="rule.cosmeticOptions!.labelStyle = !rule.cosmeticOptions!.labelStyle; updateFilter();">
                            Label
                          </button>
                          <button class="btn toggle-button" [class.active]="rule.cosmeticOptions!.minimapIcon"
                            (click)="rule.cosmeticOptions!.minimapIcon = !rule.cosmeticOptions!.minimapIcon; updateFilter();">
                            Icon
                          </button>
                          <button class="btn toggle-button" [class.active]="rule.cosmeticOptions!.playEffect"
                            (click)="rule.cosmeticOptions!.playEffect = !rule.cosmeticOptions!.playEffect; updateFilter();">
                            Beam
                          </button>
                        </span>
                        <span class="input-group-btn">
                          <button class="btn remove-btn" (click)="removeCustomCosmeticRule($index)"></button>
                        </span>
                      </div>
                      @if(rule.cosmeticOptions!.minimapIcon || rule.cosmeticOptions!.playEffect) {
                      <div class="filter filter-padded">
                        <span class="filter-body">
                          @if(rule.cosmeticOptions!.minimapIcon) {
                          <div class="filter-title" style="width: 55px">
                            Icon
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.cosmeticOptions!.minimapIconSize" (change)="updateFilter()" [disabled]="!rule.active || !rule.cosmeticOptions!.minimapIcon">
                                <option [value]="MinimapIconSize.Small">Small</option>
                                <option [value]="MinimapIconSize.Medium">Medium</option>
                                <option [value]="MinimapIconSize.Large">Large</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.cosmeticOptions!.minimapIconColor" (change)="updateFilter()" [disabled]="!rule.active || !rule.cosmeticOptions!.minimapIcon">
                                <option [value]="Color.Red">Red</option>
                                <option [value]="Color.Green">Green</option>
                                <option [value]="Color.Blue">Blue</option>
                                <option [value]="Color.Brown">Brown</option>
                                <option [value]="Color.White">White</option>
                                <option [value]="Color.Yellow">Yellow</option>
                                <option [value]="Color.Cyan">Cyan</option>
                                <option [value]="Color.Grey">Grey</option>
                                <option [value]="Color.Orange">Orange</option>
                                <option [value]="Color.Pink">Pink</option>
                                <option [value]="Color.Purple">Purple</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.cosmeticOptions!.minimapIconShape" (change)="updateFilter()" [disabled]="!rule.active || !rule.cosmeticOptions!.minimapIcon">
                                <option [value]="MinimapIconShape.Circle">Circle</option>
                                <option [value]="MinimapIconShape.Diamond">Diamond</option>
                                <option [value]="MinimapIconShape.Hexagon">Hexagon</option>
                                <option [value]="MinimapIconShape.Square">Square</option>
                                <option [value]="MinimapIconShape.Star">Star</option>
                                <option [value]="MinimapIconShape.Triangle">Triangle</option>
                                <option [value]="MinimapIconShape.Cross">Cross</option>
                                <option [value]="MinimapIconShape.Moon">Moon</option>
                                <option [value]="MinimapIconShape.Raindrop">Raindrop</option>
                                <option [value]="MinimapIconShape.Kite">Kite</option>
                                <option [value]="MinimapIconShape.Pentagon">Pentagon</option>
                                <option [value]="MinimapIconShape.UpsideDownHouse">Upside-down House</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          }

                          @if(rule.cosmeticOptions!.playEffect) {
                          <div class="filter-title" style="width: 55px">
                            Beam
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.cosmeticOptions!.playEffectColor" (change)="updateFilter()" [disabled]="!rule.active || !rule.cosmeticOptions!.playEffect">
                                <option [value]="Color.Red">Red</option>
                                <option [value]="Color.Green">Green</option>
                                <option [value]="Color.Blue">Blue</option>
                                <option [value]="Color.Brown">Brown</option>
                                <option [value]="Color.White">White</option>
                                <option [value]="Color.Yellow">Yellow</option>
                                <option [value]="Color.Cyan">Cyan</option>
                                <option [value]="Color.Grey">Grey</option>
                                <option [value]="Color.Orange">Orange</option>
                                <option [value]="Color.Pink">Pink</option>
                                <option [value]="Color.Purple">Purple</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <span class="input-group-btn">
                            <button class="btn toggle-btn" [class.off]="!rule.cosmeticOptions!.playEffectTemp" [class.disabled]="!rule.active || !rule.cosmeticOptions!.playEffect"
                            (click)="rule.cosmeticOptions!.playEffectTemp = !rule.cosmeticOptions!.playEffectTemp; updateFilter();"></button>
                          </span>
                          <span class="sep"></span>
                          <div class="filter-title filter-label" [class.disabled]="!rule.active || !rule.cosmeticOptions!.playEffect">
                            Temp
                          </div>
                          }
                        </span>
                      </div>
                      }

                      @if(rule.cosmeticOptions!.labelStyle) {
                      <div class="filter filter-padded">
                        <span class="filter-body">
                          <div class="filter-title" style="width: 55px">
                            Label
                          </div>
                          <span class="sep"></span>
                          <span class="input-group-btn">
                            <button class="btn toggle-btn" [class.off]="!rule.active || !rule.cosmeticOptions!.backgroundColor" (click)="toggleBackgroundColor(rule)"></button>
                          </span>
                          <span class="sep"></span>
                          <div class="filter-title filter-label color-picker-label" [class.disabled]="!rule.active || !rule.cosmeticOptions!.backgroundColor"
                            style="width: 135px !important">

                            <input type="text" maxlength="9" pattern="#[0-9a-fA-F]*" class="form-control minmax color-picker-dot"
                              [disabled]="!rule.cosmeticOptions!.backgroundColor"
                              [(colorPicker)]="rule.cosmeticOptions!.backgroundColor!" [style.background]="rule.cosmeticOptions!.backgroundColor"
                              cpOutputFormat="rgba" cpAlphaChannel="forced"
                              (ngModelChanged)="rule.cosmeticOptions!.backgroundColor" (colorPickerSelect)="updateFilter()">

                            <div class="color-picker-label-text">Background</div>
                          </div>
                          <span class="sep"></span>
                          <span class="input-group-btn">
                            <button class="btn toggle-btn" [class.off]="!rule.active || !rule.cosmeticOptions!.borderColor" (click)="toggleBorderColor(rule)"></button>
                          </span>
                          <span class="sep"></span>
                          <div class="filter-title filter-label color-picker-label" [class.disabled]="!rule.active || !rule.cosmeticOptions!.borderColor"
                            style="width: 100px !important">

                            <input type="text" maxlength="9" pattern="#[0-9a-fA-F]*" class="form-control minmax color-picker-dot"
                              [disabled]="!rule.cosmeticOptions!.borderColor"
                              [(colorPicker)]="rule.cosmeticOptions!.borderColor!" [style.background]="rule.cosmeticOptions!.borderColor"
                              cpOutputFormat="rgba" cpAlphaChannel="enabled"
                              (ngModelChanged)="rule.cosmeticOptions!.borderColor" (colorPickerSelect)="updateFilter()">

                            <div class="color-picker-label-text">Border</div>
                          </div>
                          <span class="sep"></span>
                          <span class="input-group-btn">
                            <button class="btn toggle-btn" [class.off]="!rule.active || !rule.cosmeticOptions!.textColor" (click)="toggleTextColor(rule)"></button>
                          </span>
                          <span class="sep"></span>
                          <div class="filter-title filter-label color-picker-label" [class.disabled]="!rule.active || !rule.cosmeticOptions!.textColor"
                            style="width: 80px !important">

                            <input type="text" maxlength="9" pattern="#[0-9a-fA-F]*" class="form-control minmax color-picker-dot"
                              [disabled]="!rule.cosmeticOptions!.textColor"
                              [(colorPicker)]="rule.cosmeticOptions!.textColor!" [style.background]="rule.cosmeticOptions!.textColor"
                              cpOutputFormat="rgba" cpAlphaChannel="enabled"
                              (ngModelChanged)="rule.cosmeticOptions!.textColor" (colorPickerSelect)="updateFilter()">

                            <div class="color-picker-label-text">Text</div>
                          </div>
                          <span class="sep"></span>
                          <span class="input-group-btn">
                            <button class="btn toggle-btn" [class.off]="!rule.active || !rule.cosmeticOptions!.fontSize" (click)="toggleFontSize(rule)"></button>
                          </span>
                          <span class="sep"></span>
                          <div class="filter-title filter-label" [class.disabled]="!rule.active || !rule.cosmeticOptions!.fontSize">
                            Size
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="min-width: 100px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.cosmeticOptions!.fontSize" (change)="updateFilter()" [disabled]="!rule.active || !rule.cosmeticOptions!.fontSize">
                                <option [value]="LabelSize.Smallest">Smallest</option>
                                <option [value]="LabelSize.Smaller">Smaller</option>
                                <option [value]="LabelSize.Small">Small</option>
                                <option [value]="LabelSize.Normal">Normal</option>
                                <option [value]="LabelSize.Large">Large</option>
                                <option [value]="LabelSize.Larger">Larger</option>
                                <option [value]="LabelSize.Largest">Largest</option>
                              </select>
                            </div>
                          </div>
                          <!-- <input type="number" placeholder="min" maxlength="2" pattern="[0-9.,]*" inputmode="numeric" step="any" class="form-control minmax"
                            [class.disabled]="!rule.active || !rule.cosmeticOptions!.fontSize"
                            [(ngModel)]="rule.cosmeticOptions!.fontSize!" (change)="updateFilter()"> -->
                          <span class="sep"></span>
                          @if(rule.itemClass === 'Stackable Currency') {
                          <div class="filter-title style-example" [class.disabled]="!rule.active" [style]="getCurrencyStyle(rule.cosmeticOptions!)">
                            {{ rule.baseTypes.length > 0 && !rule.baseTypes.includes('All') ? rule.baseTypes[0] : 'Divine Orb' }}
                          </div>
                          } @else {
                          <div class="filter-title style-example" [class.disabled]="!rule.active" [style]="getItemStyle(rule.cosmeticOptions!)">
                            {{ rule.baseTypes.length > 0 && !rule.baseTypes.includes('All') ? rule.baseTypes[0] : 'Crude Bow' }}
                          </div>
                          }
                        </span>
                      </div>
                      }
                      }

                      <div class="filter filter-padded">
                        <button type="button" class="btn clear-btn" style="width: 100%;" (click)="addCustomCosmeticRule()">
                          Add Cosmetic Rule
                        </button>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                </div>

              </div>
              } @else if (tab === 'customRules') {
              <div class="search-advanced-items">

                <div class="row row-total row-justify-content-left">
                  <div class="info reset-font">
                    Here you can create custom show, hide and highlight rules based on Item Class, Base Type and Rarity. The rules are inserted and processed in the order they are listed.
                    The higher the rule, the higher its precedence.<br/><strong>Warning!</strong> This could cause (even all) items to be hidden, or shown. Use with care.
                  </div>
                </div>

                <div class="search-advanced-pane full-width">

                  <div class="filter-group expanded">
                    <div class="filter-group-body">

                      @for (rule of filter.customRules; track $index) {
                      <div class="filter full-span">
                        <span class="input-group-btn">
                          <button class="btn toggle-btn" [class.off]="!rule.active" (click)="toggleCustomRuleActive($index)"></button>
                        </span>
                        <span class="filter-body">
                          <div tabindex="-1" class="multiselect filter-select" style="width: 180px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.itemType" (change)="itemTypeChanged(rule)" [disabled]="!rule.active">
                                <option [value]="'All'">All</option>
                                @for (itemType of itemData; track itemType.itemType) {
                                <option [value]="itemType.itemType">{{ itemType.itemType }}</option>
                                }
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <pf-autocomplete
                            [options]="getBaseTypesForItemType(rule.itemType)"
                            [disabled]="!rule.active"
                            [showOptions]="rule.itemClass !== 'All'"
                            [selectedValues]="rule.baseTypes"
                            (selectedValuesChange)="selectedValuesChanged(rule, $event)"></pf-autocomplete>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 50px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.rarityComparator" (change)="updateFilter()" [disabled]="!rule.active || currencyItemTypes.includes(rule.itemType)">
                                <option [value]="Comparator.GreaterThanOrEqual">≥</option>
                                <option [value]="Comparator.Equal">=</option>
                                <option [value]="Comparator.LessThanOrEqual">≤</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 120px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.rarity" (change)="updateFilter()" [disabled]="!rule.active || currencyItemTypes.includes(rule.itemType)">
                                <option [value]="Rarity.Normal">Normal</option>
                                <option [value]="Rarity.Magic">Magic</option>
                                <option [value]="Rarity.Rare">Rare</option>
                                <option [value]="Rarity.Unique">Unique</option>
                              </select>
                            </div>
                          </div>
                          <span class="sep"></span>
                          <div tabindex="-1" class="multiselect filter-select" style="width: 100px;">
                            <div class="multiselect__tags">
                              <select [(ngModel)]="rule.displayType" (change)="updateFilter()" [disabled]="!rule.active">
                                <option [value]="DisplayType.Hide">Hide</option>
                                <option [value]="DisplayType.Show">Show</option>
                                <option [value]="DisplayType.White">White</option>
                                <option [value]="DisplayType.Yellow">Yellow</option>
                                <option [value]="DisplayType.Orange">Orange</option>
                                <option [value]="DisplayType.Brown">Brown</option>
                                <option [value]="DisplayType.Purple">Purple</option>
                              </select>
                            </div>
                          </div>
                        </span>
                        <!-- <span class="input-group-btn" title="Continue">
                          <button class="btn toggle-btn" [class.off]="!rule.continue" (click)="rule.continue = !rule.continue; updateFilter();"></button>
                        </span> -->
                        <span class="input-group-btn">
                          <button class="btn remove-btn" (click)="removeCustomRule($index)"></button>
                        </span>
                      </div>
                      }

                      <div class="filter filter-padded">
                        <button type="button" class="btn clear-btn" style="width: 100%;" (click)="addCustomRule()">
                          Add Custom Rule
                        </button>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                </div>
              </div>
              } @else if (tab === 'freeRules') {
              <div class="search-advanced-items">

                <div class="row row-total row-justify-content-left">
                  <div class="info reset-font">
                    These rules will be inserted at the top and at the bottom of the filter, respectively. You can use this to make your own modifications, exceptions, highlights,...
                    <br /><strong>Warning!</strong> These rules could hide items unintentionally, and invalid syntax will cause the filter not to load. Use at your own risk!
                    Please read about how filters work on the <a href="https://www.pathofexile.com/item-filter/about" target="_blank">official page</a>.
                  </div>
                </div>

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Insert At Top
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span">
                        <textarea class="custom-rules" [(ngModel)]="filter.freeRulesTop" (keyup)="updateFilter()"></textarea>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>

                </div>

                <div class="search-advanced-pane blue">

                  <div class="filter-group expanded">
                    <div class="filter-group-header">
                      <div class="filter">
                        <span class="filter-body">
                          <span class="filter-title">
                            Insert At Bottom
                          </span>
                        </span>
                      </div>
                    </div>
                    <div class="filter-group-body">

                      <div class="filter filter-property full-span">
                        <textarea class="custom-rules" [(ngModel)]="filter.freeRulesBottom" (keyup)="updateFilter()"></textarea>
                      </div>

                    </div>

                    <div class="clear"></div>
                  </div>
                </div>
              </div>
              }
            </div>
            <div class="controls">
              <div class="controls-left hide-on-md">
                <button type="button" class="btn export-import-button" (click)="import()">
                  Import
                </button>
              </div>
              <div class="controls-center">
                <button type="button" class="btn download-btn" (click)="download()">
                  Download
                </button>

                <button type="button" class="btn copy-btn" (click)="copyToClipboard()">
                  {{ copyText }}
                </button>
              </div>
              <div class="controls-right">
                <button type="button" class="btn export-import-button show-on-md" (click)="import()">
                  Import
                </button>
                <button type="button" class="btn clear-btn" (click)="clear()">
                  Reset
                </button>
                <!-- <button type="button" class="btn toggle-search-btn">
                  <span alt="Toggle" class="chevron"></span>
                  Hide Filters
                </button> -->
              </div>
              <div class="clear"></div>
            </div>
          </div>
        </div>

        <div class="clear"></div>
      </div>
      <div class="clear"></div>
    </div>

    @if(importFilterError) {
    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title">Error importing filter</h2>
          <p>Make sure you're importing a filter file which was exported through this tool, and of the correct version: {{ filterVersion }}.</p>
          <p><strong>Error:</strong></p>
          <textarea class="filter-output" style="height: unset; width: 100%;">{{ importFilterError }}</textarea>
          <div class="close-info-btn" (click)="importFilterError = null">✕</div>
        </div>
      </div>
    </div>
    }

    @if(importFilterSuccess) {
    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title">Filter imported successfully!</h2>
          <p>Imported filter which was exported on {{ importFilterExportDate }} using v{{ importFilterExportVersion }}.</p>
          <div class="close-info-btn" (click)="importFilterSuccess = false">✕</div>
        </div>
      </div>
    </div>
    }

    @if(showTierWarning) {
    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title">Warning! Filtering on <strong>Unidentified Item Tiers</strong> is currently not supported by GGG!</h2>
          If you're hiding Magic or Rare Items, they will be hidden even if they are Tiered.
          Therefore, <strong>after defeating a boss</strong> or rare monster, quickly <strong>check</strong> whether they dropped any Magic Item with an Unidentified Tier.
          <div class="close-info-btn" (click)="hideTierWarning()">✕</div>
        </div>
      </div>
    </div>
    }

    <div class="results block output">
      <div class="row row-total">
        <h3>
          Filter output
        </h3>
        <!-- <button title="Default" class="layout-btn layout-immersion"></button>
        <button title="Compact" class="layout-btn layout-compact"></button>
        <button title="Compact Two-Columned" class="layout-btn layout-compact-two"></button> -->
      </div>

      <textarea class="filter-output" [disabled]="true">
{{filterText}}
      </textarea>
    </div>

    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title text-align-center bigger">Examples</h2>

          <div class="examples">
            <div class="example text-align-center">
              <img src="/examples/orb-drops-800.png" />
              <p>Currency and other items are displayed in their original style, but rare currency is highlighted using tiered beams.</p>
            </div>
            <div class="example text-align-center">
              <img src="/examples/minimap-icons-800.png" />
              <p>The minimap shows items in these same colors and using 3 icons: currency, maps, items.</p>
            </div>
            <div class="example text-align-center">
              <img src="/examples/map-tiers-800.png" />
              <p>Using a 'Dynamic Filter', Waystones are highlighted relative to where you are currently at.</p>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title bigger text-align-center">Filter Philosophy</h2>

          <div class="principles">
            <div class="principle">
              <h3 class="info-title">Minimalist Style</h3>

              <p>
                Path of Exile has <strong>beautiful graphics and a dark atmosphere</strong>. Its item color theme nostalgically goes back all the way to Diablo 2. We'd hate to spoil that by adding many different out-of-theme colors and fonts. This filter keeps all the 'default' label styles. We only add highlight beams in self-explanatory colors: white, yellow, orange, brown, and purple for top-tier items. Highlighted items are shown on the minimap too.
              </p>
            </div>

            <div class="principle">
              <h3 class="info-title">Remove Clutter</h3>

              <p>
                Halfway through the campaign, many items start dropping, most of which you won't be interested in for your character: Normal and Magic items, Weapons not usable by your build, and Armour which doesn't have the right defences. <strong>This filter hides them</strong>, always keeping a clean overview and adding to the game's beautiful atmosphere.
              </p>
            </div>

            <div class="principle">
              <h3 class="info-title">Enhance Efficiency</h3>

              <p>
                Using both the tiered color highlights and the minimap icons, you'll never miss any important item. <strong>The higher the tier, the more likely you will want to pick it up</strong>, even backtracing a bit.
              </p>
            </div>
          </div>

          <div class="principles">
            <div class="principle">
              <h3 class="info-title">Easy to use</h3>

              <p>
                Going with <strong>the defaults is just fine for most people</strong>, but it's <strong>easy to adapt</strong> it to your preferences or where you're currently at in the game. This means the filter is slightly opinionated, but probably what most players will agree on. You can always add your own custom rules using the 'Custom Rules' tab.
              </p>

              <h3 class="info-title">Nothing to learn</h3>

              <p>You <strong>don't have to learn</strong> what different <strong>colors or styles mean</strong>: the Drop Tier system is self-exaplanatory. Higher Drop Tier means more valuable.

            </div>

            <div class="principle">
              <h3 class="info-title">Market-value Drop Tiers</h3>

              <p>
                Currency can be more or less rare -- that is, they have a <strong>higher or lower market value</strong> -- a product of their utility divided by their drop chance. We call these <strong>Drop Tiers</strong>, white through brown (or purple if you're really lucky). All drops are highlighted using an appropriate beam and icon on the minimap. Classifying items into these Drop Tiers is <strong>based on their respective Exalt value on the in-game Currency Exchange</strong>; or, in the case of 'Dynamic Filters' like Maps, their usefulness to you currently.
              </p>
            </div>

            <div class="principle">
              <h3 class="info-title">Safety first</h3>

              <p>
                Any change to this filter is <strong>tested beforehand</strong>, and gets a test-run. All <strong>item names are always copy-pasted</strong> from https://poe2db.tw, which is actual data-mined from the game client, avoiding typos.
              </p>

              <p>
                Additionally, where possible, the filter uses a '<strong>catch all</strong>' highlight for each of the drop types, should something have been accidently left out. (Let us know if you find anything!)
              </p>

              <p>
                Lastly, this filter only explicitly hides what you tell it to hide. <strong>There's no 'hide all remaining' rule</strong>. Worst case scenario, the drop will still be shown the default way (without a highlight).
              </p>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="results block">
      <div class="row row-total row-justify-content-left">
        <div class="info">
          <h2 class="info-title bigger text-align-center">How To Use This Website</h2>
          <ol>
            <li>Download the filter file, and move it into the correct folder. For example on Windows this is <strong>%userprofile%\Documents\My Games\Path of Exile 2</strong>.
              You can open the correct folder from the Game's Settings Menu (under 'Game').</li>
            <li>Select the filter from the dropdown menu in the Game's Settings Menu (under 'Game'). The game will save it for future use, and load it on startup.</li>
            <li>If you change your filter, download the file again and move it over the existing file. Make sure the file name is still correct; your browser might have appended (1) to the file name. Then click the 'Reload' button in the Game Menu.</li>
            <li>Alternatively, copy the filter text using the 'Copy to Clipboard' button, directly in your filter file in the PoE2 directory. You'll still need to click the 'Reload' button in the Game Menu.</li>
            <li>The game will tell you when the filter was loaded correctly (or if it encountered a parsing error).</li>
            <li>This website will store your filter in the browser. However, note that upon a new version of the website, the filter might get cleared!</li>
          </ol>

          <p>
            For more information and a thorough guide on the Path Of Exile and Path Of Exile 2 Item Filters,
            check out the <a href="https://www.pathofexile.com/item-filter/about" target="_blank">official page</a>.
          </p>

        </div>
      </div>
    </div>

    <div class="results block">
      <div class="row row-total row-justify-content-left display-block">
        <div class="info">
          <h2 class="info-title bigger text-align-center">Feedback & support</h2>
          <p class="text-align-center">
            <strong>Feedback and bugreports</strong> are welcome at the <strong><a href="https://www.pathofexile.com/forum/view-thread/3630063" target="_blank">PoE Forum Thread</a></strong>.
            You'll also find the the <strong>release notes</strong> there. If you'd prefer to have a chat, come join me on <strong><a href="https://discord.gg/JbaMnwngvq" target="_blank">Discord</a></strong>!
          </p>
          <p class="text-align-center">
            You can find the <strong>source code</strong> on <strong><a href="https://github.com/vincentsels/poe2filter" target="_blank">GitHub</a></strong>.
          </p>
          <p class="text-align-center">
            I'm making and updating this website in my spare time. You can <strong>support</strong> me by <strong><a href="https://buymeacoffee.com/poe2filter" target="_blank">buying me a coffee</a></strong>!
            But more importantly, if you like this filter & website, don't forget to <strong>spread the word</strong>!
          </p>

        </div>
      </div>
    </div>

    <div class="results block last-block">
      <div class="row row-total row-justify-content-left display-block">
        <div class="info">
          <h2 class="info-title bigger text-align-center">What People Are Saying</h2>
          <div class="praises">
            <div class="praise">
              <span class="praise-text">
                This is awesome! I love the more default/stylized look of the filter, and it was so easy to set up. It really feels like it was developed by GGG. 10/10 keep up the good work and I can't wait to see more updates :)
              </span>
              <div class="author">OriginalPhee</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Cool filter, i've rolled with the default output you provided on the website and it's very sweet. Thanks!
              </span>
              <div class="author">zelme95</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                I love the filter. It was so simple to customize, it felt like this should be how the in-game loot filter should feel like.
              </span>
              <div class="author">Celd</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Heya, thanks for your site/tool! It's been handy to help me start with a clean slate for my characters, then tweak some values as I figure out what loot I want to pay attention to.
              </span>
              <div class="author">dreamsequel</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Looks good so far. I'll probably use this until release, at least, when there's more data for an autoscaling filter. Thank you for the effort!
              </span>
              <div class="author">UnDeaD_CyBorG</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Hey, this looks amazing. As soon as I have time to play I'm going to try to create a lootfilter. Thanks for your work!
              </span>
              <div class="author">Thoriorx</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Dude, this is super cool stuff. With your filter generator i can quickly make ssf filters for my characters.
              </span>
              <div class="author">the_longest_cat</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Really good filter and simple to customize, thanks a lot for the awesome tool.
              </span>
              <div class="author">Maygriev</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                If it works, as I'm expecting, great job! looking forward to trying it tomorrow.
              </span>
              <div class="author">Luigi_4477</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Just got to maps and excited to try this out tomorrow. Thanks!
              </span>
              <div class="author">cantonian23</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                This is amazing, thank you! I really wish they let you make the filter in game...
              </span>
              <div class="author">DualDier</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Nice filter and editor, I appreciate the clean default look.
              </span>
              <div class="author">Kazang</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Fantastic work so far. Thank you!
              </span>
              <div class="author">M3tamorph</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                The Dynamic Map Filter works great.
              </span>
              <div class="author">arkon9944</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Loving site layout. Looks so good.
              </span>
              <div class="author">InvictaVultis</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Thanks so much for this, working great.
              </span>
              <div class="author">Mysickduck1</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                This is awesome, many thanks!
              </span>
              <div class="author">Quakespeare</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Awesome work OP !
              </span>
              <div class="author">Haunting-Gift-8289</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Awesome tool, exactly what i was looking for.
              </span>
              <div class="author">medicindisguise</div>
            </div>
            <div class="praise">
              <span class="praise-text">
                Hype! Big thanks!
              </span>
              <div class="author">PARAS0706</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="bottom">
      <span class="copyright">
        This website is in no way affeliated with GGG.
        <span class="version">v{{ filterVersion }}</span>
      </span>
      <br>
    </div>
  </div>
</div>
